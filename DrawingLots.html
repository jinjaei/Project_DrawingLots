<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제비뽑기</title>
</head>
<body>
    <div style="display: inline-block;">인원수 </div>
    <button id="pPlus">+</button>
    <button id="pMinus">-</button> &emsp;
    <div style="display: inline-block;" id="personCount"> 5 </div>
    <div style="display: inline-block;">&emsp; &emsp; 꽝 개수 </div>
    <button id="lPlus">+</button>
    <button id="lMinus">-</button> &emsp;
    <div style="display: inline-block;" id="lotCount"> 1 </div>
    <p><div id="guide">버튼을 눌러 제비를 섞어 주세요</div></p>
    <p><button style="position: relative;">제비 섞기</button></p>

    <script>
        const $personCount = document.querySelector('#personCount');
        const $lotCount = document.querySelector('#lotCount');
        const $pPlus = document.querySelector('#pPlus');
        const $pMinus = document.querySelector('#pMinus');
        const $lPlus = document.querySelector('#lPlus');
        const $lMinus = document.querySelector('#lMinus');
        
        for(i=0; i<5; i++){ // 최초에 제비 이미지 5개 생성
            img = document.createElement('img');
            img.src = "./제비.png";
            img.width="100"; img.height="120";
            document.body.appendChild(img);
        }
        $lMinus.disabled = 'disabled';

        const lots = ['통과','통과','통과','통과','꽝']; // 기본 세팅 : 통과 제비 4개, 꽝 제비 1개
        let reset = false; // 꽝 제비 초기화를 위한 변수

        const pButton = () => {
            if(event.target.textContent === '+'){
                img = document.createElement('img');
                img.src = "./제비.png";
                img.width="100"; img.height="120";
                document.body.appendChild(img); // 제비 이미지 추가

                reset = false;
                $pMinus.disabled = false;
                $lPlus.disabled = false;
                $personCount.textContent++;
                lots.unshift('통과'); // 배열 맨 앞에 통과 제비 추가
                if($personCount.textContent == 10){ // 인원수가 10이 되면
                    $pPlus.disabled = 'disabled'; // 인원수 + 버튼 클릭 불가
                }
            }
            if(event.target.textContent === '-'){
                var lotList = document.getElementsByTagName('img')
                document.body.removeChild(lotList[0]); // 제비 이미지 제거

                $pPlus.disabled = false;
                $personCount.textContent--;
                lots.shift('통과'); // 배열 맨 앞의 통과 제비 제거

                if(reset){ // 인원수와 꽝 개수가 같아질 때 꽝 제비 초기화
                    reset = false;
                    $lotCount.textContent = 1;
                    $lPlus.disabled = false;
                    $lMinus.disabled = 'disabled';
                    for(i=0; i<lots.length-1; i++){
                        lots.unshift('통과');
                        lots.pop('꽝');
                    }
                }
                if($lotCount.textContent == $personCount.textContent-1){ // 인원수-1이 꽝 개수가 같을 때
                    reset = true;
                    $lPlus.disabled = 'disabled'; // 꽝 개수 + 버튼 클릭 불가
                }
                if($personCount.textContent == 2){ // 인원수가 2가 되면
                    $pMinus.disabled = 'disabled'; // 인원수 - 버튼 클릭 불가
                }
            }
            
            if($personCount.textContent == 2){ // 인원수가 2명이면
                $lPlus.disabled = 'disabled'; // 꽝 개수 + 버튼 클릭 불가
            }
            console.log(lots);
        }

        const lButton = () => {
            if(event.target.textContent === '+'){
                $lMinus.disabled = false;
                $lotCount.textContent++;
                lots.shift('통과');
                lots.push('꽝');
                if($lotCount.textContent == $personCount.textContent-1){
                    reset = true;
                    $lPlus.disabled = 'disabled';
                }
            }
            if(event.target.textContent === '-'){
                reset = false;
                $lPlus.disabled = false;
                $lotCount.textContent--;
                lots.unshift('통과');
                lots.pop('꽝');
                if($lotCount.textContent == 1){ // 꽝 개수가 1이면
                    $lMinus.disabled = 'disabled'; // 꽝 개수 - 버튼 클릭 불가
                }
            }
            console.log(lots);
        }
        $pPlus.addEventListener('click', pButton);
        $pMinus.addEventListener('click', pButton);
        $lPlus.addEventListener('click', lButton);
        $lMinus.addEventListener('click', lButton);
    </script>
</body>
</html>